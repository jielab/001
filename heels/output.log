/mnt/d/software/heels/run_HEELS.py:1195: SyntaxWarning: invalid escape sequence '\%'
  logging.info("Approximated \% of LD: {}%".format(100 - F_norm / LD_norm * 100))
/mnt/d/software/heels/run_HEELS.py:1351: SyntaxWarning: invalid escape sequence '\%'
  logging.info("Approximated \% of LD: {}%".format(100 - F_norm / LD_norm * 100))

<><><<>><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
<>
<> HEELS: Heritability Estimator with high Efficiency using LD and Summary Statistics 
<> Version: 1.0.1
<> (C) 2022 Hui Li, Rahul Mazumder and Xihong Lin
<> Harvard University Department of Biostatistics
<> MIT Sloan School of Management, Operations Research Center and Center for Statistics and Data Science
<> MIT License Copyright (c) 2023 Hui Li 
<><><<>><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
<> Note:  It is recommended to run your own QC on the input before using this program. 
<> Software-related correspondence: hui_li@g.harvard.edu 
<><><<>><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>


Calling ./run_HEELS.py \
--output-fp bmi \
--sumstats-fp bmi.txt \
--ld-snp-fp /mnt/d/software/heels/data/ukb_332k_chr22_maf01_geno1 \
--ld-fp /mnt/d/data/ldref/heels/ukb_332k_chr22_LD.npz \
--N 300000 \
--stream-stdout  \
--init-values 0.1,0.9 \
--calc-var  

Beginning HEELS analysis...
Parsing the full LD matrix from file
Dropped 0 SNP due to invalid LD information
LD parsing is complete.
Number of markers: 8298.
<><><<>><><><><><><><><><><><><><><><><><><><><><><><><><><><><>

No low-dimensional LD decomposition is conducted.
<><><<>><><><><><><><><><><><><><><><><><><><><><><><><><><><><>

Parsing summary statistics from file
/mnt/d/software/heels/run_HEELS.py:1222: FutureWarning: The 'delim_whitespace' keyword in pd.read_csv is deprecated and will be removed in a future version. Use ``sep='\s+'`` instead
  df_ss = pd.read_csv(args.sumstats_fp, delim_whitespace=True, index_col=None)
Number of SNPs in sumstats: 7117
Aligning sumstats with LD info and selecting overlapped markers only
/mnt/d/software/heels/run_HEELS.py:224: FutureWarning: The 'delim_whitespace' keyword in pd.read_csv is deprecated and will be removed in a future version. Use ``sep='\s+'`` instead
  df_bim = pd.read_csv(ld_snp_fp, delim_whitespace=True, index_col=None, names=['CHR','SNP','pos','BP','A1','A2'])
block_m number: 8298, and size of the SNP info file: 8298
Number of SNPs in the LD: 8298
Number of SNPs overlapped between sumstats and LD 633
<><><<>><><><><><><><><><><><><><><><><><><><><><><><><><><><><>

Preparing the Z-scores for running HEELS and adjust by n and p
<><><<>><><><><><><><><><><><><><><><><><><><><><><><><><><><><>

Start running HEELS
HEELS procedure started at Thu May  1 07:52:25 2025
Iteration: 0
7-th leading minor not positive definite
Traceback (most recent call last):
  File "/mnt/d/software/heels/run_HEELS.py", line 1366, in <module>
    sigma_g, sigma_e, i, sigma_g_list, sigma_e_list, Z_ll_path, Y_ll_path = run_HEELS(args, Z_m, LD_dict, sigma_g_0, sigma_e_0, m, n, YtY=args.YtY, update_sigma_g="Seq", tol=tol, maxIter=args.maxIter)
                                                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/d/software/heels/run_HEELS.py", line 670, in run_HEELS
    BLUP_t, trace, Z_ll = HEELS_iter(lam, m, n, Z_m, LD_dict['LD_banded'], YtY)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/d/software/heels/run_HEELS.py", line 455, in HEELS_iter
    chol = cholesky_banded(W_t, lower = True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jiehuang001/anaconda3/envs/heels/lib/python3.12/site-packages/scipy/linalg/_decomp_cholesky.py", line 320, in cholesky_banded
    raise LinAlgError("%d-th leading minor not positive definite" % info)
numpy.linalg.LinAlgError: 7-th leading minor not positive definite
Analysis terminated from error at Thu May  1 07:52:25 2025
Total time elapsed: 4.62s
Total time elapsed: 4.621981859207153s
<><><<>><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
